# RTS Camera
(旧名：EnhancedMission, Enhanced Mission RTS Camera)

这是一个骑马与砍杀2：霸主的mod，提供了包括自由视角在内的一系列功能。

## 存档兼容性
本mod不会读写你的存档数据。安装或卸载本mod不会对你的存档造成影响。

## 主要功能

- 自由视角 RTS Camera

  - 战斗中丝滑切换自由视角。

  - **新功能：** 让相机跟随选定的编队。

  - 玩家角色在战场上受伤后可控制下属士兵并继续战斗和指挥。

  - 兵牌可直接点击。

- 指挥系统 Command System

  - 可下达集中冲锋指令。

    - **新功能：** 可在下达集中攻击指令的同时维持原本的移动指令。例如，**让你的弓箭手待在原地同时攻击指定的目标**。

  - **新功能：** 修复游戏内的指令位置标记的若干问题。

  - 鼠标中键点击你的士兵来选择你的编队。

  - 自由视角下的移动目标标记替换成了更显眼的模型。

## 主要用法

- 自由视角 RTS Camera

  - 按`F10`可切换自由视角。

  - **新功能:** 自由视角下打开指挥界面后，按`E`键可让相机跟随选定的编队。

  - 玩家阵亡后后按`E`可以让相机跟随一个士兵，然后再按一次`E`控制该士兵继续战斗。

    - 你可以按`L`打开菜单，勾选`阵亡后控制队友`选项，玩家阵亡后自动控制队友继续战斗。

  - 可通过点击兵牌来选择部队。
   
    - 可以按`Alt`显示鼠标以点击兵牌。

- 指挥系统 Command System

  - 鼠标中键点击敌人士兵来下达集中冲锋指令。

    - **新功能：** 鼠标中键点击同时按下`Alt`键，可在下达集中攻击指令的同时维持原有的移动指令不变。例如，**让你的弓箭手待在原地同时攻击指定的目标**。

  -鼠标中键点击你的士兵来选择你的编队。

- 更多功能，你可看下面的`详细信息`，或者按`L`键打开mod菜单。

## 如何安装

1. 解压缩下载下来的压缩包，复制`RTSCamera`和`RTSCamera.CommandSystem`文件夹到砍二的`Modules`文件夹中。或者你可以使用Vortex来自动安装。

## 详细信息

- 战斗中按`L`键打开本mod的菜单。

  - 点击菜单左侧的`自由视角`和`指挥系统`来在两部分功能间切换。

  - 要关闭该菜单，你可以按`esc`键，左键点击菜单外的区域，或点击右键。

### 自由视角RTS Camera

- 按`F10`可切换自由视角。

  切换到自由视角时玩家角色会由AI操控。

  - 如果显示“死亡时无法下达指令”，请按两次E以控制一个单位，然后你就可以下达指令了。

  - 指挥界面会自动打开。

  - 你可以启用`指挥时切换相机`选项，指挥时自动切换到自由视角。

  - **新功能：** 自由视角下打开指挥界面后，按`E`键可让相机跟随选定的编队。

  - 你可以启用`自动慢速模式`，这样自由视角下自动开启慢速模式。

  - 自由视角下的操控：

    - 用`W`, `A`, `S`, `D`, `空格`, `Z`和鼠标滚轮来移动相机。

    - 用`shift`来加速移动相机。

    - 移动鼠标来旋转相机。或者当命令面板打开后，右键拖动鼠标来旋转相机。

    - 选中部队后左键在地面上拖动来改变部队的位置，方向和宽度。

      - 按住`ctrl`再拖动来让选中的多个编队前后排列。

    - 按住`ctrl`再滚动鼠标滚轮来调整镜头移动速度。

    - 按住`ctrl`并点击鼠标中键来重设鼠标速度。

    - 按住`ctrl`然后垂直拖动鼠标中键来调整相机高度。

- 玩家阵亡后后按`E`可以让相机跟随一个单位，然后再按一次`E`控制该士兵继续战斗。

  - 你可以启用`阵亡后控制队友`选项，玩家阵亡后自动控制队友，以避免你的部队变为由AI指挥。自由视角下玩家阵亡后会自动控制队友以避免中断指挥。

  - 玩家阵亡后会优先控制同编队的队友。

- 当相机跟随单位时，按`E`可控制该单位。以下方式可以让相机跟随单位：

  - 自由视角下按`E`控制玩家单位。

  - 按`L`打开菜单，在`观察另一个英雄单位`下拉列表中选择一个英雄单位。

  - 按`;`然后点击一个单位，随后按`E`。

  - 点击鼠标左右键可以更改相机跟随的单位。

- 可通过点击兵牌来选择部队。

- 如果玩家在地图上受伤然后碰到了敌军，尽管你不能直接上战场，但可以选择`指挥这场战斗`选项来开始战斗。该战斗中你可以在自由视角下指挥部队，但不能直接控制任何一个单位。

- 启用`限制相机距离`选项后，自由视角下相机到玩家角色的距离会被限制。

  - 最大距离由侦察和战术等级决定。

  - 启用`限制相机距离`选项后，使用自由视角和在自由视角中指挥，会提高侦察和战术等级。

### 指挥系统Command System

- 鼠标中键点击敌人士兵来下达集中冲锋指令。

  - 敌军被消灭以后，你的部队会待在原地。要改变这个行为，你可以按`L`打开菜单，然后把选项`消灭敌方编队后`设置为`冲锋`。

  - 自由视角下打开指挥界面后，被攻击的敌方编队会用红色轮廓高亮。

- **新功能：** 鼠标中键点击同时按下`Alt`键，可在下达集中攻击指令的同时维持原有的移动指令不变。

  - 对于弓箭手，可以让他们攻击指定目标同时待在原地。

  - 注意对于近战士兵，他们仍会执行之前的移动指令，这可能让他们无法攻击到目标。

- 自由视角下的移动目标标记更加显眼。游戏原本的标记在相机太远时很难辨别。

- 鼠标中键点击你的士兵来选择你的编队。

  - 自由视角下选中的编队会用绿色标记。

- 自由视角下打开指挥界面后，你被敌方攻击的编队会用深蓝色轮廓高亮。

- 兵牌下方会显示当前移动指令。

## 快捷键
你可以按`L`打开菜单，然后点击`按键绑定`来设置快捷键。

你可以点击`+`和`-`按钮来编辑按键序列。

以下是默认快捷键：

- `L`: 打开菜单。

- `Middle Mouse Button`: 指挥系统中选择编队。

- `F10`: 切换自由视角

- `E`: 相机跟随单位/编队；控制单位。

- `;`: 选择单位。

- `w`, `A`, `S`, `D`: 相机移动。

- `Space`, `Z`: 相机升降。

- `Right Shift` + `=`, `Right Shift` + `-`: 提高/降低相机距离限制。

还有更多快捷键可设置，但为了防误触我把它们禁用了。要想设置，请按`L`打开菜单，然后点击`按键绑定`。


## 配置文件
本mod的配置保存在文件夹`(user directory)\Documents\Mount and Blade II Bannerlord\Configs\RTSCamera\`和`(user directory)\Documents\Mount and Blade II Bannerlord\Configs\MissionLibrary\`中。

  主要配置保存在文件`RTSCameraConfig.xml`和`CommandSystemConfig.xml`中。

  按键配置保存在文件`RTSCameraGameKeyConfig.xml`和`CommandSystemGameKeyConfig.xml`中。

  打开mod菜单的按键配置保存在文件`(user directory)\Documents\Mount and Blade II Bannerlord\Configs\MissionLibrary\GeneralGameKeyConfig.xml`中。

  你可以修改配置，但如果你编辑有误或配置文件被移除，配置会被初始化为默认内容。

## 解决问题
- 若启动器无法启动：

  - 卸载所有第三方mod，然后一个个重装它们来找出哪个mod导致了启动器不能启动。

- 若提示"Unable to initialize Steam API":

  - 请先启动Steam，并确保砍二在你登录的Steam账号的库中.

- 若mod启用后游戏崩溃：

  - 若提示: `Cannot load: ..\..\Modules\RTSCamera\bin\Win64_Shipping_Client\RTSCamera.dll`，请将`Modules\RTSCamera`和`Modules\RTSCamera.CommandSystem`下的所有dll文件解除锁定。

  - 若你能将dump文件发送给我来帮助我解决你的崩溃问题，我会十分感谢。步骤如下：

    - 游戏崩溃时在弹窗询问是否收集信息时点击`是`或`Yes`。

    - 在游戏把崩溃信息发送给TaleWorlds之前，到`C:\ProgramData\Mount and Blade II Bannerlord\crashes`中(**注意不是游戏安装路径**)根据时间找到与该崩溃相关的文件夹。

    - 将该文件夹中的`dump.dmp`文件发送给我。

- 若你忘了你设置的用哪个按键打开mod菜单：

  - 你可以移除文件`(user directory)\Documents\Mount and Blade II Bannerlord\Configs\MissionLibrary\GeneralGameKeyConfig.xml`，这样打开mod菜单的按键会恢复为默认。

## 可选文件
- ["Battle Mini Map"](https://www.nexusmods.com/mountandblade2bannerlord/mods/2672): 战斗小地图.

- ["Improved Combat AI"](https://www.nexusmods.com/mountandblade2bannerlord/mods/449/): 可调整战斗AI，可选择更真实的格挡。

- ["Cinematic Camera"](https://www.nexusmods.com/mountandblade2bannerlord/mods/1627): 调整相机参数，如移动速度，景深等等。

## 源代码

你可以在[github.com](https://github.com/lzh-mb-mod/RTSCamera)获取到源代码。

## 联系方式
- 邮箱：

  - lizhenhuan1019@outlook.com

  - lizhenhuan1019@qq.com
